## **모평균 비교에 관한 가설검정(One way ANOVA 및 사후검정)**

### 분산분석(Analysis of Variance, ANOVA)

- 분산분석 개요
    - **2개 이상의 모집단의 모평균의 차이를 검정** → 표본평균의 변동성을 구함
    - **평균 차이를 파악하기 위해 변동성을 이용** : 그룹 별 **평균이 다르면 그룹 별 평균의 변동성이 크다는 사실**을 이용함.
- 용어
    - 요인(factor) : 모집단(그룹)의 구분기준
    - 처리(treatment(levels)) : 요인을 구성하는 각 모집단(그룹)

### 일원분산분석(One Way ANOVA)

- 일원배치 자료의 구조
    - 1개의 요인에 대해 k개의 처리(그룹)로 분류되어 있는 자료
- 일원배치 분산분석 예시
    - 3가지 타입의 자동차의 헤드라이트 디자인을 고려하고 있다. 라이트의 효과를 비교하기 위하여, 각 디자인을 적용한 차량별로 시속 60km의 속도에서 장애물을 인지하는 거리(m)를 5번씩 반복하여 측정하였다. 이 자료를 토대로 라이트 종류에 따라 인지거리에 차이가 있는지를 유의수준 1%로 검정하고자 한다.
    - 요인 : 디자인
    - 처리 : 3가지 A타입, B타입, C타입
    - 반응 변수 : 거리
- 일원배치 분산분석 가정
    - **정규, 등분산, 독립**
    - 1개의 요인에 대해 k개의 처리(그룹)로 분류되어 있는 자료.
    - k개의 모평균 $\mu_1, \mu_2, …, \mu_k$이 모두 동일한지 아닌지를 검정하고자 함

- 제곱합의 분해
    - $\sum_{i=1}^k \sum_{j=1}^n (y_{ij} - \bar y)^2 = \sum_{i=1}^k \sum_{j=1}^n (y_{ij} - \bar y_i)^2 + \sum_{i=1}^k \sum_{j=1}^n (y_{i} - \bar y)^2$
    - 총변동성(SST) = 오차에의한변동(SSE) + 요인에의한변동(SSRE)
    = 그룹 내 변동 + 그룹 간 변동
    - 총제곱합(SST) : 그룹에 무관한 전체 자료의 변동을 측정
    - 오차제곱합(SSE) : 각 그룹 내에서의 변동을 측정
    - 요안제곱합(SSTR) : 각 그룹 별 평군의 변동을 측정
        - SSTR의 크기로 집단 별 모평균 차이를 파악할 수 있음
    
    ![Untitled](img/Untitled%2012.png)
    

- 그룹 내 변동과 그룹 간 변동
    - 그룹 별 모평균이 모두 동일한 경우의 그룹 간 변동은 그룹 내 변동에 의존함.
        
        ![Untitled](img/Untitled%2013.png)
        
    - 그룹 간 모평균 차이를 파악하기 위해서는, **그룹 내 변동에 비해 그룹 간 변동의 상대적 크기를 측정**해야함.

### One way ANOVA 검정 절차

- 가설
    - 귀무가설 $H_0$ : 집단 간 평균의 차이는 없음
    - 대립가설 $H_1$ : 집단 간 평균의 차이가 존재함. (해당 요인의 처리 효과 있음)
- 검정 통계량
    - 평균 제곱 : 제곱합들을 각각의 자유도로 나눈 값
    MSTR = SSTR / (k-1), MSE = SSE/(nk-k)
    - 만일 그룹 별 모평균이 같다면, $MSTR \approx MSE$
    만일 그룹 별 모평균이 모두 같지 않다면 $MSTR \gt MSE$
    - 귀무가설($H_0$)이 사실인 경우,
    $X = \dfrac {MSTR} {MSE} \sim F[k-1, nk- k]$
- 유의확률(p-value)의 계산
    - 귀무가설 $H_0$가 사실일 때,
    - 검정통계량 X의 분포 $X = \dfrac {MSTR} {MSE} \sim F[k-1, nk- k]$에서,
    - $x_0$(=표본 자료로부터 계산된 검정통계량의 값)보다 **더 큰 값이 나올 확률**
        - 만약 모평균이 다르다고 가정하면 MSE는 가만히 있고 MSTR이 커짐
- 유의수준(significance level) $100 \alpha \%$의 검정법
    - 자료로부터 계산된 유의확률(p-value)이 주어진 유의수준 $\alpha$보다 작은 경우에 귀무가설 $H_0$를 기각함.
    $p-value \le \alpha$면, $H_0$를 기각
    - 분산분석표
        
        
        |  | 제곱합 | 자유도 | 평균제곱 | F값 |
        | --- | --- | --- | --- | --- |
        | 요인 | SSTR | k-1 | MSTR | $F = \dfrac {MSTR} {MSE}$ |
        | 잔차 | SSE | nk-k | MSE |  |
        | 합계 | SST | nk-1 |  |  |

### 사후검정

- 분산분석은 모든 집단의 모평균이 동일한지, 하나 이상의 집단에서 모평균의 차이가 나는지에 대해서만 파악함. 따라서 집단 별 차이가 존재하는 것으로 결론이 나더라도 **어느 집단에서 차이가 발생하는지는 알 수 없음**
- 사후 검정을 통해 어떤 집단에서 차이가 발생하는지를 확인할 수 있음
- 다양한 사후 검정 방법이 있음
    - Fisher의 LSD방식
        - 그룹이 3개가 있으면 $\mu_1과 \mu_2$가 같은지 다른지 검정 한 번 $\mu_1, \mu_3$ 한 번, $\mu_2, \mu_3$ 한 번 총 3번에 걸쳐서 확인한다.
    - Tukey의 W방식
    - Duncan의 Multiple Range Test
    - Scheffe의 S 방법
    - Dunnett의 방식
