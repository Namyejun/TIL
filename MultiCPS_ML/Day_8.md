## **계층적 군집분석(Hiararchical Clustering)**

### 군집분석

- 어떤 개체나 대상들을 밀접한 유사성 또는 비유사성에 의하여 유사한 특성을 지닌 개체들을 몇 개의 군집으로 집단화하는 비지도학습법
- 각 군집의 특성, 군집간의 차이 등에 대한 탐색대상으로 집단에 대한 심화된 이해가 목적
- 특이 군집의 발견, 결측값의 보정 등에도 활용될 수 있음.

### 군집의 조건

- 동일 군집에 속한 개체끼리는 유사한 속성이 매우 많음
- 다른 군집에 속하는 개체끼리는 유사한 속성이 매우 적음

### 계층적 군집분석 개요

- 병합적(agglomerative) vs 분할적(divisive)
    - 병합적 : 개체 간 거리가 가까운 개체끼리 차례로 묶어주는 방법으로 군집을 정의.
    - 분할적 : 개체간 거리가 먼 개체끼리 나누어 가는 방법으로 군집을 정의
    - 계층적 군집 분석에서는 병합적 방법이 주로 사용됨.

### 병합적 방법에서 단일연결법 사용 군집분석 예시

- 군집분석의 결과를 Dendrogram으로 시각화
- 군집 간 거리가 멀고, 군집 내 거리가 가까워지도록 적절한 지점에서 절단하여 군집 수 결정
    
    ![Untitled](img/Untitled%206.png)
    

### 개체 간 거리 및 군집 간 거리의 정의

- 개체 간 거리
    - 유클리디안 거리
    - 맨해튼 거리
    - 민코우스키 거리
- 군집 간 거리
    - 단일 연결법(최단 연결법, single linkage)
    - 완전 연결법(최장 연결법, complete linkage)
    - 평균 연결법(average linkage)
    - 중심 연결법(centroid linkage)
    - ward 연결방법(ward linkage)
    

### 군집 간 거리

- 단일 연결법(최단 연결법, single linkage)
    - 두 군집 $C_1, C_2$의 거리는 $d_{C_1C_2} = min\{d(x,y)|x \in C_1, y \in C_2\}$로 정의
- 완전 연결법(최장 연결법, complete linkage)
    - 두 군집 $C_1, C_2$의 거리는 $d_{C_1C_2} = max\{d(x,y)|x \in C_1, y \in C_2\}$로 정의
- 평균 연결법(average linkage)
    - 두 군집 $C_1, C_2$의 거리는 두 군집의 모든 개체간 거리들의 평균으로 정의
- 중심 연결법(centroid linkage)
    - 두 군집 $C_1, C_2$의 거리는 두 군집의 중심 사이의 거리로 정의
- ward 연결방법(ward linkage)
    - $SSE_k$를 군집 $k$의 중심으로부터 해당 군집 각 개체 간의 거리 제곱 합으로 정의한 뒤,
    총 $K$개의 군집이 있다면 $SSE = \displaystyle\sum_{k=1}^K SSE_k$로 정의
        - sum of square error : 군집의 중심으로 부터의 각 개체 간의 거리 제곱 합
    - K개 중 2개의 군집을 하나의 군집으로 묶었을 때 오차 제곱합이 증가하는 정도를 두 군집 간의 거리로 정의