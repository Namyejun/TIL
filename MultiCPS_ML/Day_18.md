## **의사결정나무 모델: 분류 나무(Classification Tree)**

### 의사결정 나무 모형

- 의사결정규칙(decision rule)을 나무 구조로 도표화하여 관심대상이 되는 집단을 몇 개의 소집단으로 분할하는 방식으로 분류 및 예측하는 분석 방법
    - 목표변수가 범주형인 경우 : 분류 나무(classification tree)
    - 목표변수가 연속형인 경우 : 회귀 나무(regression tree)

### 의사결정 나무의 종류

- 의사결정나무 알고리즘은 CHAID, CART, C5.0, QUEST 등과 이들의 장점을 결합한 다양한 알고리즘이 있음
- 주요 알고리즘의 특징

![Untitled](img/Untitled%2021.png)

### 의사결정 나무의 구조

![Untitled](img/Untitled%2022.png)

- 뿌리마디(root node) : 시작되는 마디로 전체 자료로 구성됨
- 자식마디(child node) : 하나의 마디로부터 분리되어 나간 2개 이상의 마디들
- 부모마디(parent node) : 주어진 마디의 상위 마디
- 끝마디(terminal node) : 자식마디가 없는 마디
- 중간마디(internal node) : 부모마디와 자식마디가 모두 있는 마디
- 깊이(depth) : 뿌리마디부터 끝마디까지 중간마디의 수

### 의사결정나무 분석절차

- 나무의 성장(growing) : 각 마디에서 적절한 최적의 분리규칙(splitting rule)을 찾아 나무를 성장 시킴. 정지규칙(stopping rule)을 만족하는 경우는 성장 중단.
- 가지치기(prunning) : 오류율(error rate)을 크게 할 위험이 높거나 부적절한 추론 규칙을 가지고 있는 가지를 제거
- 타당성 평가 : 평가자료(test data)를 이용하여 의사결정나무를 평가
- 해석 및 예측 : 구축된 나무 모형을 해석하고 분류 및 예측 모형을 설정

### 나무의 성장(growing)

- 상위노드로부터 하위노드로 나무구조를 형성하는 매 단계마다 분리규칙(어느 특성변수로 어떻게 분할할 것인가)을 선택함
- 분리규칙의 형태(이진분할의 경우)
    - 연속형 특성 변수 : 분리에 사용될 특성변수 X와 분리점 c를 이용하여 X < c 면 왼쪽 자식마디, 그렇지 않으면 오른쪽 자식마디로 자료를 분리
    - 범주형 특성 변수 : 분리에 사용될 특성변수 X가 가지는 전체범주 중 부분집합인 A를 이용하여 $X \in A$ 면 왼쪽 자식마디, 그렇지 않으면 오른쪽 자식마디로 자료를 분리
- 분류기준은 해당 노드에서 그 기준으로 하위노드를 분기하였을 때, 하위 노드 내에서는 동질성이 하위 노드 간에는 이질성이 가장 커지도록 선택됨

### 분류나무의 분류규칙 탐색

- 불순도
    
    Y의 범주가 j = 1, … ,C로 구성될 때 t노드에서의 불순도 imp(t)는 다음과 같이 정의됨.
    
    p(i|t) : t 마디로 분류했는데 범주 j에 속할 확률이라고 할 때,
    
    - 지니 불순도 (gini impurity) :  $imp(t) = 1 - \displaystyle \sum_{j=1}^C p(i|t)^2$
    - 엔트로피 불순도 (entropy impurity) :  $imp(t) = - \displaystyle \sum_{j=1}^C p(i|t)logp(i|t)$
    - 불순도가 클수록 자식노드 내 이질성이 큼을 의미함. 불순도가 가장 작아지는 방향으로 가지분할을 수행함
- 불순도의 향상된 정도(Goodness of split) G(s, t)
    
    어떤 부모마디 t에서 분리기준 s로 분리한 뒤 생성된 두 자식마디를 $t_L, t_R$이라고 할 때,
    $G(s,t) = imp(t) - \dfrac {N(t_L)} {N(t)} \cdot imp(t_L) - \dfrac {N(t_R)} {N(t)} \cdot imp(t_R)$
    
    - N(t) : t 마디에서 자료의 수
    - imp(t) : t 마디에서의 불순도
- 모든 특성변수와 그 특성변수의 모든 가능한 분리점에 대하여 G(s, t)를 구한 뒤 G(s, t)가 가장 큰 특성변수 및 분리점을 해당 마디에서의 분리기준으로 정함