## **ê·œì œê°€ ìˆëŠ” ì„ í˜•íšŒê·€ëª¨ë¸ (Ridge, Lasso, Elastic Net)**

### ì„ í˜•íšŒê·€ëª¨ë¸ì˜ ê·œì œ

- ëª¨í˜•ì˜ ê³¼ëŒ€ì í•©ì„ ë§‰ê¸° ìœ„í•œ ê·œì œ ë°©ë²•(regularization)ìœ¼ë¡œ ì„ í˜•íšŒê·€ëª¨í˜•ì—ì„œëŠ” ë³´í†µ ëª¨ë¸ì˜ ê°€ì¤‘ì¹˜ë¥¼ ì œí•œí•˜ëŠ” ë°©ë²•ì„ ì‚¬ìš©í•¨.
    - ì„ í˜•íšŒê·€ëª¨ë¸ì˜ ë¹„ìš©í•¨ìˆ˜
    $J(\beta) = \dfrac 1 n \displaystyle \sum_{i=1}^n (y_i - \beta_0 - \beta_1x_{1i} - \beta_2x_{2i} - ... - \beta_kx_{ki})^2$
    - ê·œì œê°€ ìˆëŠ” ê²½ìš° ë¹„ìš©í•¨ìˆ˜
    $J(\beta) = \dfrac 1 n \displaystyle \sum_{i=1}^n (y_i - \beta_0 - \beta_1x_{1i} - \beta_2x_{2i} - ... - \beta_kx_{ki})^2 + \lambda \cdot penalty(\beta_1, ..., \beta_k)$
    ìˆ˜ì§ê±°ë¦¬ ì œê³±í•©ì˜ í‰ê· ì„ ìµœì†Œë¡œ ë§Œë“¤ë˜ íŒ¨ë„í‹°ì˜ ì¶”ê°€ë¡œ ì¸í•´ $\hat \beta$ì˜ í¬ê¸°ë„ ì»¤ì§€ì§€ ì•Šë„ë¡ í•˜ëŠ” ê²ƒ
        
        ìˆ˜ì§ê±°ë¦¬ ì œê³±í•©ì„ ì¤„ì´ëŠ” ê²ƒì— ë¹„ì¤‘ì„ ë‘˜ ê²ƒì¸ì§€, ì•„ë‹ˆë©´ $\beta$ ë“¤ì˜ íŒ¨ë„í‹°ë¥¼ ì¤„ì´ëŠ” ê²ƒì— ë” ë¹„ì¤‘ì„ ë‘ëŠ”ì§€ ê²°ì •í•˜ëŠ”ê²Œ $\lambda$ì´ë‹¤.
        
        - $\lambda$ê°€ ì‘ìœ¼ë©´ ìˆ˜ì§ê±°ë¦¬ ì œê³±í•©ì„ ì¤„ì´ëŠ”ë°ì— ë¹„ì¤‘ì„ ë‘ 
        - $\lambda$ê°€ í¬ë©´ $\beta$ ë“¤ì˜ íŒ¨ë„í‹°ë¥¼ ì¤„ì´ëŠ” ê²ƒì— ë¹„ì¤‘ì„ ë‘ 
        - 0ì´ë©´ ìˆ˜ì§ê±°ë¦¬ ì œê³±í•©ì˜ ë¹„ìš©ê³¼ ë™ì¼

- ê°€ì¤‘ì¹˜ë¥¼ ì œí•œí•˜ëŠ” ë°©ë²•ì— ë”°ë¥¸ ê·œì œ ì„ í˜•íšŒê·€ëª¨ë¸ì˜ ì¢…ë¥˜
    - ë¦¿ì§€íšŒê·€(Ridge Regression)
    - ë¼ì†ŒíšŒê·€(Lasso Regression)
    - ì—˜ë¼ìŠ¤í‹±ë„·(Elastic Net)
    
    <aside>
    ğŸ’¡ $L_p \ norm = \bigg( \sum_{j = 1}^k |\beta_j|^p\bigg)^{1/p}$
    ë¦¿ì§€ : p = 2
    ë¼ì˜ : p = 1
    ì—˜ë¼ìŠ¤í‹±ë„· : ë¦¿ì§€ì™€ ë¼ì˜ì˜ ì¥ì ì„ ë‘˜ ë‹¤ ì·¨í•˜ê¸° ìœ„í•´ ë§Œë“¤ì–´ì§„ ê²ƒ
    
    </aside>
    

### ë¦¿ì§€íšŒê·€(Ridge Regression)ì™€ L2 ê·œì œ

- ë¦¿ì§€íšŒê·€ì˜ ë¹„ìš©í•¨ìˆ˜
    - ë¹„ìš©í•¨ìˆ˜ $J(\beta)$ì— ê·œì œí•­ $\lambda \cdot \sum_{j=1}^k \beta_j^2$ì´ ì¶”ê°€ëœ ì„ í˜•ëª¨í˜•
        
        $J(\beta) = \dfrac 1 n \displaystyle \sum_{i=1}^n (y_i - \beta_0 - \beta_1x_{1i} - \beta_2x_{2i} - ... - \beta_kx_{ki})^2 + \lambda \cdot \sum_{j=1}^k \beta_j^2$
        
    - $\lambda$(ê·œì œ ì •ë„ë¥¼ ê²°ì •í•˜ëŠ” í•˜ì´í¼ íŒŒë¼ë¯¸í„°)
        - $\lambda$ê°€ í¬ë©´ ê·œì œ ë§ìŒ. íšŒê·€ ê³„ìˆ˜ ì¶”ì •ì¹˜ê°€ ì‘ì•„ì§.
        - $\lambda$ê°€ 0ì´ë©´ ì¼ë°˜ ì„ í˜•íšŒê·€ ëª¨ë¸ê³¼ ë™ì¼í•œ ê²°ê³¼
        - ì ì ˆí•œ $\lambda$ëŠ” êµì°¨ê²€ì¦(cross-validation)ë“±ìœ¼ë¡œ ìµœì í™”

- ë¦¿ì§€íšŒê·€ì˜ í›ˆë ¨
    - ë¹„ìš©í•¨ìˆ˜ $J(\beta)$ë¥¼ ìµœì†Œë¡œí•˜ëŠ” íšŒê·€ê³„ìˆ˜ $\hat \beta^R = (\hat \beta_0^R, \hat \beta_1^R, â€¦, \hat \beta_k^R)$ë¥¼ ì°¾ëŠ” ë¬¸ì œ.
    $\hat \beta^R = arg \ \underset {\beta} {min} \ J(\beta)$
- Alternative Fomulation
    - ì–´ë–¤ ì„ì˜ì˜ \lambdaì— ëŒ€í•´ ì´ì— ëŒ€ì‘í•˜ëŠ” í•˜ë‚˜ì˜ tê°€ ì¡´ì¬í•˜ì—¬ ì•„ë˜ ì‹ìœ¼ë¡œ ë™ì¼í•œ í•´ $\hat \beta^R$ë¥¼ ì–»ê²Œ ë¨.
        
        $\hat \beta^R = arg \ \underset {\beta} {min} \ \bigg\{ \dfrac 1 n \displaystyle \sum_{i=1}^n (y_i - \beta_0 - \beta_1x_{1i} - \beta_2x_{2i} - ... - \beta_kx_{ki})^2 + \lambda \cdot \sum_{j=1}^k \beta_j^2\bigg\} \ subject \ to \ \sum_{j=1}^k \beta_j^2 \le t$
        
        - $\beta$ì— ëŒ€í•´ ë²”ìœ„ë¥¼ í•œì •ì‹œí‚´. ì›ì´ë‚˜ êµ¬ ê·¸ëŸ° ë²”ìœ„ë¡œ ì œí•œë¨.
            
            ![Untitled](img/Untitled%2015.png)
            
            - ì‚¬ì§„ ì† $\hat \beta$ëŠ” ì¼ë°˜ ì„ í˜•íšŒê·€ëª¨í˜•ì˜ ë¹„ìš© ìµœì†Œì 
            - í•˜ì§€ë§Œ $\beta$ì— ë…¸ë€ìƒ‰ ë²”ìœ„ê°€ ê±¸ë ¤ìˆìŒ

### ë¼ì˜íšŒê·€(Lasso Regression)ì™€ L1 ê·œì œ

- ë¼ì˜íšŒê·€ì˜ ë¹„ìš©í•¨ìˆ˜
    - ë¹„ìš©í•¨ìˆ˜ $J(\beta)$ì— ê·œì œí•­ $\lambda \cdot \sum_{j=1}^k |\beta_j|$ì´ ì¶”ê°€ëœ ì„ í˜•ëª¨í˜•
        
        $J(\beta) = \dfrac 1 n \displaystyle \sum_{i=1}^n (y_i - \beta_0 - \beta_1x_{1i} - \beta_2x_{2i} - ... - \beta_kx_{ki})^2 + \lambda \cdot \sum_{j=1}^k |\beta_j|$
        
    - $\lambda$(ê·œì œ ì •ë„ë¥¼ ê²°ì •í•˜ëŠ” í•˜ì´í¼ íŒŒë¼ë¯¸í„°), êµì°¨ê²€ì¦ ë“±ìœ¼ë¡œ ìµœì í™”

- ë¦¿ì§€íšŒê·€ì˜ í›ˆë ¨
    - ë¹„ìš©í•¨ìˆ˜ $J(\beta)$ë¥¼ ìµœì†Œë¡œí•˜ëŠ” íšŒê·€ê³„ìˆ˜ $\hat \beta^L = (\hat \beta_0^L, \hat \beta_1^L, â€¦, \hat \beta_k^L)$ë¥¼ ì°¾ëŠ” ë¬¸ì œ.
    $\hat \beta^L = arg \ \underset {\beta} {min} \ J(\beta)$
    - Alternative Fomulation
        - ì–´ë–¤ ì„ì˜ì˜ \lambdaì— ëŒ€í•´ ì´ì— ëŒ€ì‘í•˜ëŠ” í•˜ë‚˜ì˜ tê°€ ì¡´ì¬í•˜ì—¬ ì•„ë˜ ì‹ìœ¼ë¡œ ë™ì¼í•œ í•´ $\hat \beta^L$ë¥¼ ì–»ê²Œ ë¨.
            
            $\hat \beta^L = arg \ \underset {\beta} {min} \ \bigg\{ \dfrac 1 n \displaystyle \sum_{i=1}^n (y_i - \beta_0 - \beta_1x_{1i} - \beta_2x_{2i} - ... - \beta_kx_{ki})^2 + \lambda \cdot \sum_{j=1}^k |\beta_j|\bigg\} \ subject \ to \ \sum_{j=1}^k |\beta_j| \le t$
            
            - $\beta$ì— ëŒ€í•´ ë²”ìœ„ë¥¼ í•œì •ì‹œí‚´. ë²”ìœ„ ì œí•œë¨.
                
                ![Untitled](img/Untitled%2016.png)
                
                - ì‚¬ì§„ ì† $\hat \beta$ëŠ” ì¼ë°˜ ì„ í˜•íšŒê·€ëª¨í˜•ì˜ ë¹„ìš© ìµœì†Œì 
                - í•˜ì§€ë§Œ $\beta$ì— ë…¸ë€ìƒ‰ ë²”ìœ„ê°€ ê±¸ë ¤ìˆìŒ
                - ë¼ì˜ íšŒê·€ëŠ” ì € ë²”ìœ„ë¥¼ ì§€ì¼œì•¼í•˜ë¯€ë¡œ ìì£¼ íšŒê·€ê³„ìˆ˜ì˜ ê°’ì´ 0ì´ ë˜ëŠ” ê²½ìš°ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.

### ë¦¿ì§€íšŒê·€ì™€ ë¼ì˜íšŒê·€ì˜ íŠ¹ì§•

- ë‘ ë°©ì‹ ëª¨ë‘ ì¶”ì •ì¹˜ëŠ” ì¼ë°˜ì„ í˜•íšŒê·€ëª¨í˜•ê³¼ëŠ” ë‹¬ë¦¬ í¸ì˜ê°€ ë°œìƒí•˜ì§€ë§Œ ë¶„ì‚°ì€ ë” ì‘ì•„ì§€ê²Œ ë¨
    - ì¶”ì •ì¹˜ê°€ 0 ë¶€ê·¼ì—ì„œë§Œ ì¶”ì •ë˜ë„ë¡ ë²”ìœ„ë¥¼ í•œì •ì§€ì–´ ë†“ì•˜ê¸° ë•Œë¬¸ì— ì•„ë¬´ë¦¬ ë³€ë™í•´ë„ ì„ í˜•íšŒê·€ ëª¨ë¸ì˜ í¬ê¸°ìì²´ê°€ ë³„ë¡œ ë³€í•˜ì§€ì•ŠìŒ
    
    â†’ $\lambda$ì— ë”°ë¼ ì¼ë°˜í™”ì˜¤ì°¨ê°€ ë” ì‘ì•„ì§ˆ ìˆ˜ ìˆìŒ
    
- ë¼ì˜ íšŒê·€ì˜ ê²½ìš° ì œì•½ ë²”ìœ„ê°€ ê°ì§„ í˜•íƒœ
    
    â†’ íŒŒë¼ë¯¸í„°ì˜ ì¼ë¶€ê°€ 0ì´ ë˜ëŠ” ê²½í–¥ì´ ìˆìŒ. (sparse model)
    
- ë¦¿ì§€ íšŒê·€ì˜ ê²½ìš° ì œì•½ ë²”ìœ„ê°€ ì›ì˜ í˜•íƒœ
    
    â†’ íŒŒë¼ë¯¸í„°ê°€ 0ì´ ë˜ì§€ ì•Šê³  ì „ë°˜ì ìœ¼ë¡œ ì¤„ì–´ë“œëŠ” ê²½í–¥ì´ ìˆìŒ
    

### ì—˜ë¼ìŠ¤í‹± ë„·(Elastic Net)

- L1ê³¼ L2 ê·œì œë¥¼ í˜¼í•©í•œ ë°©ì‹
- ì—˜ë¼ìŠ¤í‹± ë„·ì˜ ë¹„ìš©í•¨ìˆ˜
$J(\beta) = \dfrac 1 n \displaystyle \sum_{i=1}^n (y_i - \beta_0 - \beta_1x_{1i} - \beta_2x_{2i} - ... - \beta_kx_{ki})^2 + \lambda_1 \cdot \sum_{j=1}^k \beta_j^2 + \lambda_2 \cdot \sum_{j=1}^k |\beta_j|$
- ë¦¿ì§€íšŒê·€ì™€ ë¼ì˜íšŒê·€ì˜ ì¥ì ì„ ëª¨ë‘ ê°€ì§
    - ë¼ì˜ë¥¼ ì“°ë©´ ë³€ìˆ˜ì„ íƒì„ í•˜ëŠ”ë° ì¤‘ë³µë˜ëŠ” ì •ë³´ê°€ ì¡´ì¬í•˜ë©´ ê±”ë„¤ë“¤ì„ ëŒ€ë¶€ë¶„ íƒˆë½ì‹œí‚¤ê³  í•œ ë‘ ê°œë§Œ ë‚¨ê¸°ëŠ”ê²Œ ë‹¨ì ì¸ë°, ì •ë§ ì¤‘ìš”í•œ ë…ë¦½ë³€ìˆ˜ì— ëŒ€í•´ì„œëŠ” ì¼ì •í•œ ê³„ìˆ˜ ìˆ˜ì¤€ìœ¼ë¡œ ë‚¨ê¸¸ ìˆ˜ ìˆë„ë¡ í•´ ë‘ ëª¨ë¸ì˜ ì¥ì ì„ ì·¨í•¨.