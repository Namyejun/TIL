# 데이터 엔지니어링(패스트 캠퍼스)

## Ch 02. AWS 활용 기초

### 1. AWS와 EC2 인스턴스 소개

AWS : 클라우드 서비스로 IT 인프라를 필요한만큼 비용을 내고 사용하고 필요없을 때는 언제든지 반납할 수 있다.

Hadoop 강의는 AWS EMR 사용할 것임

EC2(Elastic Cloud Computing) : AWS 컴퓨팅 리소스를 그때그때 유연하게 사용하는 것. 가장 기본의 서버

### 2. key 파일 저장하기

- 인스턴스 만들기
    
    EC2들어가기
    
    region 서울 선택
    
    인스턴스 들어가기
    
    인스턴스 시작
    
    이름 짓기
    
    이미지 고르기 : 내가 사용할 서버가 기본적으로 설치할 운영체제, 어떤 한 상태의 snapshot이기에 이미지 → 프리티어
    
    아키텍쳐 선택
    
    인스턴스 유형 선택 → 프리티어
    
    키 페어 만들기 → RSA, .ppk
    
    - .pem : OpenSSH 이용함 (mac, linux)
    - .ppk : PuTTY 이용함 (windows)
    
    네트워크 세팅 → allow all
    
    스토리지 구성 → 8GB, gp2
    
    인스턴스 개수 설정 → 1개
    
    인스턴스 id : i-0fbd6c11c02d5ae91
    
- VPC ID?
- 퍼블릭 IPv4 DNS? 외부에서 접속할 때 필요한 주소

### 3. Putty로 EC2 인스턴스 접속하기 - windows

- Putty : 가상 단말기 프로그램
    
    SSH, 텔넷, rlogin, raw TCP를 위한 클라이언트로 동작하는 자유 및 오픈 소스 단말 에뮬레이터 응용 프로그램이다.
    
    서버는 물리적으로 떨어져 있어도 단말 장비를 통해서 원격으로 접속해서 작업해야함. 이때 윈도우같은 개인 PC운영체제에서도 서버로 접속할 수 있도록 물리적 단말장비가 아닌 논리적 가상 단말기로 들어가는 것.
    
    접속 방식으로는 Telnet, SSH, Rlogin 등
    
- 접속하는 방법
    
    key 파일이 .pem인 파일은 Putty gen 프로그램을 사용해 .ppk로 바꿔줘야한다.
    
    세션 탭에서 Host name 입력 → ubuntu@**퍼블릭 IPv4 DNS**
    
    telnet : 23번 포트, ssh : 22번 포트
    
    connection - ssh - auth에서 키 입력해줌
    
    다시 세션탭가서 open
    
    세션정보를 save하고 load 할 수 있음
    

### 4. FTP로 EC2에 파일 전송, 다운로드 하기

파일질라 사용

- host 만들기
    
    FTP 다운로드 후 설정에서 SFTP 탭 누르고 key 파일 추가
    
    그리고 호스트 새로만들고 프로토콜은 SFTP 선택
    
    호스트에는 퍼블릭 IPv4 DNS 적어주고 포트에는 22(ssh) 적어준다
    
    비밀번호 저장 누르고 호스트 신뢰를 누른다
    
    완료가 되면 상태랑 local 디렉토리와 remote 디렉토리 등이 뜬다
    
- local에서 remote로 파일 옮기기
    
    파일 드래그 해서 옮겨주고 putty를 이용해서 확인해줄 수 있다.
    
- remote에서 local로 받아오기
    
    동일하게 드래그앤 드롭으로 해결가능
    

키파일이 변경되거나 인스턴스가 꺼지거나 하면 주소도 바뀌고 여튼 좋지 않은 상황이 생긴다

### 5. 예상 요금 계산하기

AWS의 비용을 계산하는 것이다.

회사에서 클라우드 서비스의 비용을 물어볼 수 있음

EC2, RDS 등등을 싹 다 추가하고 공유나 내려받을 수 있음

### 6. AWS 기초 개념

- VPC(Virtual Private Cloud) = 네트워크
    - 논리적으로 분리한 서브네트워크, AWS 환경내의 네트워크 최소 단위
    - 사용자의 AWS 계정 전용 가상 네트워크, 하나의 리전에 대해 계정 당 하나의 VPC
    - EC2와 같은 AWS 리소스를 VPC에서 실행 가능
    - VPC에서 실행된 AWS 리소스는 다른 AWS 리소스 혹은 인터넷에 연결 가능
- subnet
    - 서브넷은 VPC의 분할된 IP 주소 범위이다. VPC CIDR 블럭을 서브넷으로 지정
    - 각 서브넷은 단일 가용 영역 내에서만 존재해야하며, 여러 영역으로 확장할 수 없다.
    - 별도의 가용영역에서 인스턴스를 시작함으로써, 단일 영역에서 장애가 발생할 경우 애플리케이션을 보호할 수 있다.
- CIDR(Classless Inter-domain Routing)
    - 클래스 없는 도메인 간 라우팅 기법
    - network 파트와 host파트를 구분할 수 있고 특정 host가 어떤 network에 포함되는지 빠르게 확인이 가능하다.
    - IPv4는 8비트가 4번 등장하는 구조로 되어있고 뒤에 /24와 같이 /를 이용하여 CIDR을 표현한다.
    - /24의 경우 24 비트를 network파트로 이용하고 나머지를 host로 이용한다는 뜻이다.
    - 192.168.1.1/24의 경우 앞의 24비트에 해당하는 192.168.1가 network파트에 해당한다. 192.168.1.0 ~ 192.168.1.255가 동일한 network 파트에 속한다.
    - VPC에 연결된 subnet은 vpc에 비해 더 높은 서브넷 마스크,  더 적은 ip범위를 갖게 된다. 그니까 network파트가 넓다는 얘기이다.
    - 예약 IP 주소
        - 10.0.0.0 : network address
        - 10.0.0.1 : VPC router
        - 10.0.0.2 : DNS server
        - 10.0.0.3 : 미래에 AWS에서 필요한 경우 사용하기 위해 남겨둠.
        - 10.0.0.255 : network broadcast 주소
- Internet Gateway
    - VPC와 인터넷을 연결해주는 하나의 관문이다.
    - VPC와 Internet간의 통신을 가능하게 해준다. subnet의 라우팅 테이블에 172.31.0.0/16에 매칭되지 않은 ip의 경우 0.0.0.0/0에 해당되는 internet gateway로 라우팅 된다.
- NAT Gateway
    - 프라이빗 서브넷이 인터넷과 통신하기 위한 아웃바운드 인스턴스이다.
    - 프라이빗 네트워크가 외부에서 요청되는 인바운드는 필요없더라도 아웃바운드 트래픽만 허용되어야 하는 경우 사용된다.
    - NAT Gateway는 프라이빗 서브넷에서 외부로 요청하는 아웃바운드 트래픽을 받아 Internet Gateway와 연결한다.
- Security Group & ACL
    - 둘 다 방화벽과 같은 역할을 하며 트래픽에 대하 보안정책을 설정할 수 있다.
    - 보안그룹
        - 인스턴스 기준으로 적용 (서비스 기준 적용)
        - 룰에 대한 허용 규칙만 적용
        - 아웃바운드 요청에 대한 응답 자동 허용
    - ACL
        - 서브넷 기준 적용
        - 룰에 대한 허용 및 거부 규칙 적용
        - 아웃 바운드 요청에 대한 응답 규칙 적용 필요

![Untitled](/FastCPS_DE/img/Untitled.png)

**AWS 내에 각각 다른 Region**

**Region 내에 또 다른 VPC**

**VPC 내에 여러 개의 Subnet**

**Subnet 안에 여러 개의 인스턴스**

- Region과 Available Zone
    - Region을 선택하는 이유
        - 응답 속도 : 지리적으로 AWS 센터와 사용자의 거리가 가까울수록 빠르다.
        - 서비스 요금은 리전에 따라 다르다.
    - Available zone은 하나의 region안에 장애로 격리된 여러개의 데이터 센터
        - 장애 방지 대책이다. 각 Available zone은 전용선이 깔려있다.